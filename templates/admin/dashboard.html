{% extends "Base.html" %}
{% block head %}
    <title>پنل ادمین</title>
{% endblock %}
{% block body %}
    <form action="#" method="post" enctype="multipart/form-data">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
        <input type="file" name="file" id="file" accept=".zip,application/zip,application/x-zip-compressed">
        <select name="grade" id="grade">
            <option selected disabled value="">انتخاب مقطع</option>
            <option value="1">دوره اول ابتدایی</option>
            <option value="2">دوره دوم ابتدایی</option>
            <option value="3">دوره متوسطه اول</option>
            <option value="4">دوره متوسطه دوم</option>
            <option value="0">فرهنگی</option>
        </select>
        <input type="submit" value="ثبت فایل">
    </form>
    <button onclick="update_like()">بروزرسانی لایک های کاربران</button>
    <script>

        function update_like() {
            swal({
                title: 'از انجام آپدیت لایک ها اطمینان دارید؟',
                html: "این عمل ممکن است ترافیک سایت شما را اشغال کند!",
                type: 'warning',
                reverseButtons: true,
                showCancelButton: true,
                confirmButtonColor: '#F38524',
                confirmButtonText: '<div style="direction:rtl;font-size:18px;font-family:Iran,Calibri;font-weight:bold;"><i style="margin-left: 5px;" class="fa fa-times"></i> تایید</div>',
                cancelButtonText: '<div style="direction:rtl;font-size:18px;font-family:Iran,Calibri;font-weight:bold;border: 3 solid #ffd700;"><i style="margin-left: 5px;" class="fa fa-times"></i> انصراف</div>',
                showLoaderOnConfirm:true,
                allowOutsideClick:false,
                showCloseButton: false,
                focusConfirm: true,
            }).then((result) => {
                if(result.value){
                    const xhr = new XMLHttpRequest();
                    var url = '/admin/likes_calculator'
                    xhr.open('GET',url, true);
                    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                    xhr.send();
                    setInterval(function() {
                        location.reload();
                }, 250); 
            };
        });
        }
    </script>
{% endblock %}